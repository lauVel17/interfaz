<main id="main" class="main">
  <div class="mb-3">
    <div class="d-flex justify-content-between align-items-center">
      <h3 class="card-title">Administrar proyectos</h3>

      <div class="d-flex gap-2">
        <button class="btn btn-success" (click)="crearProyecto()">
          <i class="bi bi-folder-plus"></i> Crear Proyecto
        </button>

        <div class="btn-group">
          <button
            type="button"
            class="btn btn-success dropdown-toggle"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <i class="bi bi-printer"></i> Imprimir
          </button>
          <ul class="dropdown-menu">
            <li>
              <button class="dropdown-item" (click)="descargarPdf()">
                <i class="bi bi-file-earmark-pdf"></i> Exportar a PDF
              </button>
            </li>
            <li>
              <button class="dropdown-item" (click)="descargarExcel()">
                <i class="bi bi-file-earmark-spreadsheet"></i> Exportar a Excel
              </button>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-bordered table-hover table-sm">
          <thead class="thead-dark">
            <tr>
              <th scope="col">Nombre</th>
              <th scope="col">Descripción</th>
              <th scope="col">Ciudad</th>
              <th scope="col">Fecha Inicio</th>
              <th scope="col">Fecha Fin</th>
              <th scope="col">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let proyecto of paginatedProyectos()">
              <td>{{ proyecto.nombre || 'No disponible' }}</td>
              <td>{{ proyecto.descripcion || 'No disponible' }}</td>
              <td>{{ proyecto.ciudad || 'No disponible' }}</td>
              <td>{{ proyecto.fechaInicio | date: 'shortDate' }}</td>
              <td>{{ proyecto.fechaFin | date: 'shortDate' }}</td>
              <td class="text-center">
                <button
                  class="btn btn-info btn-sm"
                  (click)="verDetalle(proyecto.id)"
                >
                  <i class="bi bi-eye-fill"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>

        <div *ngIf="proyectos.length === 0" class="alert alert-warning text-center">
          No hay proyectos disponibles.
        </div>
      </div>
    </div>
  </div>

  <!-- Selector de cantidad por página -->
  <div *ngIf="proyectos.length > 0" class="pagination-container">
    <nav aria-label="Page navigation">
      <ul class="pagination">
        <li class="page-item show-items">
          <div class="ext">
            <label for="itemsPerPage" class="texto me-2">Mostrar:</label>
          </div>
          <select
            id="itemsPerPage"
            (change)="cambiarItemsPorPagina($event)"
            class="form-select form-select-sm pagination-select"
            [value]="itemsPerPageString"
          >
            <option *ngFor="let opcion of opcionesPorPagina" [value]="opcion">
              {{ opcion }}
            </option>
            <option value="Todos">Todos</option>
          </select>
        </li>
      </ul>
    </nav>
  </div>

  <!-- Paginación -->
  <div *ngIf="proyectos.length > itemsPerPage">
    <nav aria-label="Page navigation">
      <ul class="pagination">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <a class="page-link" (click)="cambiarPagina(currentPage - 1)">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li
          class="page-item"
          *ngFor="let page of totalPages()"
          [class.active]="page === currentPage"
        >
          <a class="page-link" (click)="cambiarPagina(page)">
            {{ page }}
          </a>
        </li>
        <li
          class="page-item"
          [class.disabled]="currentPage === totalPages().length"
        >
          <a class="page-link" (click)="cambiarPagina(currentPage + 1)">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</main>